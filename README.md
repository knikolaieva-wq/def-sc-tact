# Payment Processor for TON

Проект содержит пример смарт-контракта Tact `PaymentProcessor`, повторяющего ключевую логику предоставленного Solidity контракта `PaymentProcessorERC20`. Контракт рассчитан на прием платежей в TON, верификацию подписи покупателя и распределение комиссии между основной и дополнительной платформой.

## Структура проекта

```
contracts/
  payment_processor.tact   # основной контракт
scripts/
  ...                      # место для будущих CLI-скриптов деплоя
tests/
  helpers/
    paymentProcessorModel.js  # модель контракта для юнит-тестов
  payment_processor.test.js   # покрытие сценариев оплаты
testnet/
  config.json              # конфигурация тестовой сети TON
```

## Тестирование

Для воспроизведения логики контракта добавлена модель на JavaScript и тесты, выполняемые встроенным раннером `node:test`.

```bash
node --test
```

Тесты проверяют:
- расчёт комиссий (`previewPayment`),
- корректное распределение средств между продавцом, платформой и дополнительным кошельком,
- отказ при нарушении подписи и дедлайна,
- возврат излишне переведённых средств.

## Конфигурация тестнета

Файл `testnet/config.json` содержит базовый шаблон подключения к `toncenter` для сети testnet, а также параметры кошелька и рекомендуемый запас TON на деплой. Перед использованием необходимо указать собственный публичный ключ и сид-фразу кошелька.

## Дополнительные шаги

1. Сгенерируйте кошелек в тестнете TON и поместите его мнемонику в `testnet/wallet.mnemonic`.
2. Реализуйте скрипт деплоя (например, на основе `tonweb` или `ton-core`), используя параметры из конфигурации.
3. Проверьте контракт на интеграцию с реальными кошельками и адаптируйте модель тестов под Jetton, если требуется поддержка токенов.
